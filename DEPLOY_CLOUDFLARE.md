# Deploying to Cloudflare (Workers with Assets)

Cloudflare has recently unified Pages into Workers. We will use the modern "Workers with Assets" flow.

## Prerequisites

1.  A Cloudflare Account.
2.  GitHub Repository connected.

## Configuration (Completed)

We have added `wrangler.json` to your project which tells Cloudflare how to serve your Next.js app.

## Deployment Steps

1.  **Push to GitHub**: Ensure `wrangler.json` is pushed to your repository.

2.  **Go to Cloudflare Dashboard**:
    *   Workers & Pages -> **Create application**.
    *   **Connect to Git**.
    *   Select your `FusionLab` repository.

3.  **Configure Build**:
    *   **Project name**: `hardi-fusion-lab`
    *   **Framework preset**: **None** (We are using a custom Workers config).
    *   **Build command**: `npm run pages:build`
    *   **Deploy command**: `npx wrangler deploy`
    *   **Path to Worker**: Leave empty or set to `/`. (It reads `wrangler.json`).
    *   **Build Output Directory**: *Leave empty*. (The `wrangler.json` `assets` field handles this).

4.  **Important**:
    *   If the dashboard asks for "Build output directory" and you CANNOT leave it empty, set it to `.vercel/output/static`.
    *   The key is that `npm run pages:build` generates the files, and `npx wrangler deploy` uploads them based on `wrangler.json`.

5.  **Save and Deploy**.

## Troubleshooting

*   If `npx wrangler deploy` fails in the dashboard, ensure `wrangler.json` is present in the root of your repo.
*   The `main` field in `wrangler.json` points to the worker generated by the build process.
